import {DataSet} from "./../../../lib/dataset.js";
import {DatasetFactory} from "./../../../lib/dataset-factory.js";
import {DataSetConstants} from "./../../../lib/dataset-constants.js";

describe("dataset-factory-tests", () => {
    let factory;
    let schema;

    beforeEach(() => {

        schema = {
            variables: {
                parameters: {
                    testCode: 1234
                }
            },
            datasets: [
                {
                    id: 0,
                    name: "model",
                    fields: [
                        {
                          name: "code",
                          default: "@parameters.testCode"  
                        },
                        {
                            name: "notes",
                            default: "Work done as requested."
                        },
                    ]
                }
            ]
        };

        window.eventEmitter = {
            on: () => {
                return;
            }
        };
        
        const options = {
            schema: schema
        };
        
        factory = new DatasetFactory(options);
       
    });

    it('createDataSetFromDefinition - default inflated to dataset from schema variable', () => {
        // Act
        const dataset = factory.createDataSetFromDefinition(schema.datasets[0], null, null);

        // Assert
        chai.assert.equal(dataset["code"], schema.variables.parameters.testCode, "The value is not the same as the schema variable.");
    });


    it('createDataSetFromDefinition - default value set', () => {
        // Act
        const dataset = factory.createDataSetFromDefinition(schema.datasets[0], null, null);

        // Assert
        chai.assert.equal(dataset["notes"], schema.datasets[0].fields[1].default);
    });


});
