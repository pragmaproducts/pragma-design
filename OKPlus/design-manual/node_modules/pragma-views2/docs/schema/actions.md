# Schema actions

Use schema actions when you want to perform a function.
The functions you can call can exist on pragma-forms, the view model or remote.
Remote calls are typically server calls.

This document will explain how actions are set up and can be used.

## Parts

Actions have a number of parts, not all required.

1. id - required
2. action - required
3. parameters - not required
4. conditional - not required
5. confirmation - not required

## Id
The id property is a unique identifier for actions.
This only needs to be unique to the schema the action is defined in.

## Action
The action property defines the action that you want to perform.
These actions are in reality functions that you are calling.
Since the default context of the schema is pragma-forms, you can call any 
funciton on pragma forms or that is exposed via pragma-forms.

If you want to perform an action on the view model you can do so via the context property.
The property context on pragma-forms points to the view model.
If I have a function on the view model called save and want to call that function the action would be

```
"action": "context.save"
```

What ever you define in the parameters will be sent to that function.

Calling a remote action you need to define two things:

1. The remote function name
2. The remote resource name

```json
{
    "id: : 0,
    "action": "PauseMeter",
    "remote": "Meter",
    "parameters": {
        "Meter->Id": "model.id",
        "activity-id": 1001,
        "refresh-model": true
    }
}
```

Additionally you may need to define parameters for your actions regardless where it executes.
In the case of local functions the parameters object will be passed as parameter where as in remote calls other parameters such as URL parameters my need to be deinfed.

## Conditional Actions
These actions only execute if the conditions defined are true.
Conditions are defined on the action using the "conditional" property. 
This property is a array of conditions and all conditions has to be true for the action to execute.

It is important to note that the condition expression is standard javascript that executes in the limited scope of the context, that being pragma-forms instance.

```
"conditional": [
    {
        "expression": "model.data.code != 'code 1' && model.data.code != 'code 2'",
        "message": "@messages.mustBeActive"
    }
]
```

When the user clicks on a button that executes this action the condition is checked.
If the condition defined in the expression passes the action will execute. If it does not
the message defined will be displayed.

## Confirmations
This allows you to first prompt the user with a confirmation dialog before the action is executed.
If the user chooses no, the acction will not be executed.
Confirmation is a array where you can define a number of different scenrios.

If you simple want a confirmation dialog you can define as following:

```
"confirmation": [
    {
        "message": "do something"
    }
]
```

If you want to have different messages depending on the condition of the model you can do it as if it is a if else statement.
It is important to note that if you do not provide a condition expression the message will always show.
If you do define a expression the confirmation will only be asked if the condition is true.

```
"confirmation": [
    {
        "expression": "model.data.code == 'code 3'",
        "message": "do you want to save code 3?"
    },
    {
        "expression": "model.data.code == 'code 4'",
        "message": "do you want to save code 4?"
    },
    {
        "message": "do something"
    }
]
```

