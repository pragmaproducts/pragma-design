export async function loadComponent(path, templated) {
    loadScript(`${path}.js`);

    if (templated == true) {
        loadTemplate(`${path}.html`);
    }
}

export async function loadScript(path) {
    const script = document.createElement("script");
    script.async = true;
    script.src = path;
    script.type = "module";
    return script;
}

export async function loadModule(path, id) {
    if (window.modules == undefined) {
        window.modules = new Map();
    }

    if (window.modules.has(id)) {
        return resolve(window.modules.get(id));
    }

    const module = await import(relToAbsPath(path));
    window.modules.set(id, module);
    return module;
}

function relToAbsPath(url) {
    const a = document.createElement("a");
    a.setAttribute("href", url);
    return a.cloneNode(false).href;
}

export async function loadTemplate(path) {
    const result = await fetch(path).then(result => result.text());

    const tdoc = document.createElement("template");
    tdoc.innerHTML = result;

    return tdoc.content.querySelector("template").content;
}